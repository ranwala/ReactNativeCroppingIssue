require 'json'

package = JSON.parse(File.read(File.join(__dir__, 'package.json')))

ScanbotSDKVersion = '2.2.0'
NativeWrapperVersion = '2.2.0.7'

RNScanbotSDKSourceFiles = 'ios/RNScanbotSDK/RNScanbotSDK/*.{h,m}',
                          'ios/RNScanbotSDK/RNScanbotSDK/Components/*.{h,m}',
                          'ios/RNScanbotSDK/RNScanbotSDK/Components/**/*.{h,m}',
                          'ios/RNScanbotSDK/RNScanbotSDK/Categories/*.{h,m}',
                          'ios/RNScanbotSDK/RNScanbotSDK/DefaultUI/*.{h,m}',
                          'ios/RNScanbotSDK/RNScanbotSDK/Internal/*.{h,m}',
                          'ios/RNScanbotSDK/RNScanbotSDK/Utils/*.{h,m}'

Pod::Spec.new do |s|
    s.name              = 'RNScanbotSDK'
    s.version           = package['version']
    s.summary           = package['description']
    s.homepage          = package['homepage']
    s.authors           = package['author']
    s.license           = { :type => 'Commercial', :file => 'LICENSE' }

    s.platform          = :ios, '11.0'

    s.source            = { :http => 'https://download.scanbot.io/sdk/react-native/react-native-scanbot-sdk-' + package['version'] + '.tgz' }

    s.subspec 'OCR' do |ocr|
        ocr.dependency 'React'
        ocr.dependency 'ScanbotSDKNativeWrapper/OCR', NativeWrapperVersion
        ocr.dependency 'ScanbotSDK/OCR', ScanbotSDKVersion
        ocr.ios.vendored_frameworks = 'ScanbotSDK.framework', 'ScanbotSDKNativeWrapper.framework'
        ocr.source_files = RNScanbotSDKSourceFiles
    end

    s.subspec 'ALL' do |all|
        all.dependency 'React'
        all.dependency 'ScanbotSDKNativeWrapper/ALL', NativeWrapperVersion
        all.dependency 'ScanbotSDK/ALL', ScanbotSDKVersion
        all.ios.vendored_frameworks = 'ScanbotSDK.framework', 'ScanbotSDKNativeWrapper.framework'
        all.source_files = RNScanbotSDKSourceFiles
    end

    s.subspec 'NONE' do |none|
        none.dependency 'React'
        none.dependency 'ScanbotSDKNativeWrapper', NativeWrapperVersion
        none.dependency 'ScanbotSDK', ScanbotSDKVersion
        none.ios.vendored_frameworks = 'ScanbotSDK.framework', 'ScanbotSDKNativeWrapper.framework'
        none.source_files = RNScanbotSDKSourceFiles
    end

    s.default_subspec = 'NONE'
    s.static_framework = true
end
