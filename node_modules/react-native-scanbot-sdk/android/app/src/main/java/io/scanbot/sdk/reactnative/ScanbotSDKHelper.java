/*
    Scanbot SDK ReactNative Module
    Copyright (c) 2017 doo GmbH. All rights reserved.
*/
package io.scanbot.sdk.reactnative;

import android.app.Application;
import android.content.Context;

import com.facebook.react.bridge.Promise;
import com.facebook.react.bridge.ReadableMap;

import io.scanbot.sdk.ScanbotSDK;
import io.scanbot.sdk.sdk_native_wrapper.SBNWOperations;

public class ScanbotSDKHelper {

    private static boolean isSdkInitialized = false;

    private static synchronized void setSdkInitialized(final boolean flag) {
        isSdkInitialized = flag;
    }

    private static ScanbotSDKWrapper wrapper;

    public static Context context;
    public static ScanbotSDK internalSDK;

    public static synchronized boolean isSdkInitialized() {
        return isSdkInitialized;
    }

    public static void initializeSDK(ReadableMap configuration, final Application application, final Promise promise) {
        SBNWOperations.INSTANCE.initializeSdk(
                application,
                configuration.toHashMap(),
                new ResultProxyDelegate(promise,
                        new ResultProxyCallback() {
                            @Override
                            public void onSuccess() {
                                wrapper = new ScanbotSDKWrapper(application);
                                ScanbotSDKHelper.context = application;
                                internalSDK = wrapper.scanbotSDK;

                                setSdkInitialized(true);
                            }
                        }));
    }
}
